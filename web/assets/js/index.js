webpackJsonp([0],[,,,,function(e,t,i){var n,r;!function(s,o){n=[i(1),i(2)],void 0!==(r=function(e,t){return s.Backgrid=o(e,t)}.apply(t,n))&&(e.exports=r)}(this,function(e,t){"use strict";function i(e,t,i){var n=t-(e+"").length;n=0>n?0:n;for(var r="",s=0;n>s;s++)r+=i;return r+e}var n="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff";if(!String.prototype.trim||n.trim()){n="["+n+"]";var r=RegExp("^"+n+n+"*"),s=RegExp(n+n+"*$");String.prototype.trim=function(){if(void 0===this||null===this)throw new TypeError("can't convert "+this+" to object");return(this+"").replace(r,"").replace(s,"")}}var o=t.$,a={Extension:{},resolveNameToClass:function(t,i){if(e.isString(t)){var n=e.map(t.split("-"),function(e){return e.slice(0,1).toUpperCase()+e.slice(1)}).join("")+i,r=a[n]||a.Extension[n];if(e.isUndefined(r))throw new ReferenceError("Class '"+n+"' not found");return r}return t},callByNeed:function(){var t=arguments[0];if(!e.isFunction(t))return t;var i=arguments[1],n=[].slice.call(arguments,2);return t.apply(i,n+""?n:[])}};e.extend(a,t.Events);var l=a.Command=function(t){e.extend(this,{altKey:!!t.altKey,char:t.char,charCode:t.charCode,ctrlKey:!!t.ctrlKey,key:t.key,keyCode:t.keyCode,locale:t.locale,location:t.location,metaKey:!!t.metaKey,repeat:!!t.repeat,shiftKey:!!t.shiftKey,which:t.which})};e.extend(l.prototype,{moveUp:function(){return 38==this.keyCode},moveDown:function(){return 40===this.keyCode},moveLeft:function(){return this.shiftKey&&9===this.keyCode},moveRight:function(){return!this.shiftKey&&9===this.keyCode},save:function(){return 13===this.keyCode},cancel:function(){return 27===this.keyCode},passThru:function(){return!(this.moveUp()||this.moveDown()||this.moveLeft()||this.moveRight()||this.save()||this.cancel())}});var h=a.CellFormatter=function(){};e.extend(h.prototype,{fromRaw:function(e,t){return e},toRaw:function(e,t){return e}});var c=a.NumberFormatter=function(t){if(e.extend(this,this.defaults,t||{}),0>this.decimals||this.decimals>20)throw new RangeError("decimals must be between 0 and 20")};c.prototype=new h,e.extend(c.prototype,{defaults:{decimals:2,decimalSeparator:".",orderSeparator:","},HUMANIZED_NUM_RE:/(\d)(?=(?:\d{3})+$)/g,fromRaw:function(t,i){if(e.isNull(t)||e.isUndefined(t))return"";t=parseFloat(t).toFixed(~~this.decimals);var n=t.split("."),r=n[0],s=n[1]?(this.decimalSeparator||".")+n[1]:"";return r.replace(this.HUMANIZED_NUM_RE,"$1"+this.orderSeparator)+s},toRaw:function(t,i){if(""===(t=t.trim()))return null;for(var n="",r=t.split(this.orderSeparator),s=0;r.length>s;s++)n+=r[s];var o=n.split(this.decimalSeparator);n="";for(var s=0;o.length>s;s++)n=n+o[s]+".";"."===n[n.length-1]&&(n=n.slice(0,n.length-1));var a=1*(1*n).toFixed(~~this.decimals);return e.isNumber(a)&&!e.isNaN(a)?a:void 0}});var u=a.PercentFormatter=function(){a.NumberFormatter.apply(this,arguments)};u.prototype=new a.NumberFormatter,e.extend(u.prototype,{defaults:e.extend({},c.prototype.defaults,{multiplier:1,symbol:"%"}),fromRaw:function(e,t){var i=[].slice.call(arguments,1);return i.unshift(e*this.multiplier),(c.prototype.fromRaw.apply(this,i)||"0")+this.symbol},toRaw:function(t,i){var n=t.split(this.symbol);if(n&&n[0]&&""===n[1]||null==n[1]){var r=c.prototype.toRaw.call(this,n[0]);return e.isUndefined(r)?r:r/this.multiplier}}});var d=a.DatetimeFormatter=function(t){if(e.extend(this,this.defaults,t||{}),!this.includeDate&&!this.includeTime)throw Error("Either includeDate or includeTime must be true")};d.prototype=new h,e.extend(d.prototype,{defaults:{includeDate:!0,includeTime:!0,includeMilli:!1},DATE_RE:/^([+\-]?\d{4})-(\d{2})-(\d{2})$/,TIME_RE:/^(\d{2}):(\d{2}):(\d{2})(\.(\d{3}))?$/,ISO_SPLITTER_RE:/T|Z| +/,_convert:function(t,n){if(""===(t+"").trim())return null;var r,s=null;if(e.isNumber(t)){var o=new Date(t);r=i(o.getUTCFullYear(),4,0)+"-"+i(o.getUTCMonth()+1,2,0)+"-"+i(o.getUTCDate(),2,0),s=i(o.getUTCHours(),2,0)+":"+i(o.getUTCMinutes(),2,0)+":"+i(o.getUTCSeconds(),2,0)}else{t=t.trim();var a=t.split(this.ISO_SPLITTER_RE)||[];r=this.DATE_RE.test(a[0])?a[0]:"",s=r&&a[1]?a[1]:this.TIME_RE.test(a[0])?a[0]:""}var l=this.DATE_RE.exec(r)||[],h=this.TIME_RE.exec(s)||[];if(n){if(this.includeDate&&e.isUndefined(l[0]))return;if(this.includeTime&&e.isUndefined(h[0]))return;if(!this.includeDate&&r)return;if(!this.includeTime&&s)return}var o=new Date(Date.UTC(1*l[1]||0,1*l[2]-1||0,1*l[3]||0,1*h[1]||null,1*h[2]||null,1*h[3]||null,1*h[5]||null)),c="";return this.includeDate&&(c=i(o.getUTCFullYear(),4,0)+"-"+i(o.getUTCMonth()+1,2,0)+"-"+i(o.getUTCDate(),2,0)),this.includeTime&&(c=c+(this.includeDate?"T":"")+i(o.getUTCHours(),2,0)+":"+i(o.getUTCMinutes(),2,0)+":"+i(o.getUTCSeconds(),2,0),this.includeMilli&&(c=c+"."+i(o.getUTCMilliseconds(),3,0))),this.includeDate&&this.includeTime&&(c+="Z"),c},fromRaw:function(t,i){return e.isNull(t)||e.isUndefined(t)?"":this._convert(t)},toRaw:function(e,t){return this._convert(e,!0)}});var f=a.StringFormatter=function(){};f.prototype=new h,e.extend(f.prototype,{fromRaw:function(t,i){return e.isUndefined(t)||e.isNull(t)?"":t+""}});var m=a.EmailFormatter=function(){};m.prototype=new h,e.extend(m.prototype,{toRaw:function(t,i){var n=t.trim().split("@");if(2===n.length&&e.all(n))return t}});var p=a.SelectFormatter=function(){};p.prototype=new h,e.extend(p.prototype,{fromRaw:function(t,i){return e.isArray(t)?t:null!=t?[t]:[]}});var g=a.CellEditor=t.View.extend({initialize:function(e){this.formatter=e.formatter,this.column=e.column,this.column instanceof R||(this.column=new R(this.column)),this.listenTo(this.model,"backgrid:editing",this.postRender)},postRender:function(e,t){return null!=t&&t.get("name")!=this.column.get("name")||this.$el.focus(),this}}),v=a.InputCellEditor=g.extend({tagName:"input",attributes:{type:"text"},events:{blur:"saveOrCancel",keydown:"saveOrCancel"},initialize:function(e){v.__super__.initialize.apply(this,arguments),e.placeholder&&this.$el.attr("placeholder",e.placeholder)},render:function(){var e=this.model;return this.$el.val(this.formatter.fromRaw(e.get(this.column.get("name")),e)),this},saveOrCancel:function(t){var i=this.formatter,n=this.model,r=this.column,s=new l(t),o="blur"===t.type;if(s.moveUp()||s.moveDown()||s.moveLeft()||s.moveRight()||s.save()||o){t.preventDefault(),t.stopPropagation();var a=this.$el.val(),h=i.toRaw(a,n);e.isUndefined(h)?n.trigger("backgrid:error",n,r,a):(n.set(r.get("name"),h),n.trigger("backgrid:edited",n,r,s))}else s.cancel()&&(t.stopPropagation(),n.trigger("backgrid:edited",n,r,s))},postRender:function(e,t){if(null==t||t.get("name")==this.column.get("name"))if("right"===this.$el.css("text-align")){var i=this.$el.val();this.$el.focus().val(null).val(i)}else this.$el.focus();return this}}),y=a.Cell=t.View.extend({tagName:"td",formatter:h,editor:v,events:{click:"enterEditMode"},initialize:function(t){(this.column=t.column)instanceof R||(this.column=new R(this.column));var i=this.column,n=this.model,r=this.$el,s=a.resolveNameToClass(i.get("formatter")||this.formatter,"Formatter");e.isFunction(s.fromRaw)||e.isFunction(s.toRaw)||(s=new s),this.formatter=s,this.editor=a.resolveNameToClass(this.editor,"CellEditor"),this.listenTo(n,"change:"+i.get("name"),function(){r.hasClass("editor")||this.render()}),this.listenTo(n,"backgrid:error",this.renderError),this.listenTo(i,"change:editable change:sortable change:renderable",function(e){var t=e.changedAttributes();for(var i in t)t.hasOwnProperty(i)&&r.toggleClass(i,t[i])}),this.updateStateClassesMaybe()},updateStateClassesMaybe:function(){var e=this.model,t=this.column,i=this.$el;i.toggleClass("editable",a.callByNeed(t.editable(),t,e)),i.toggleClass("sortable",a.callByNeed(t.sortable(),t,e)),i.toggleClass("renderable",a.callByNeed(t.renderable(),t,e))},render:function(){var e=this.$el;e.empty();var t=this.model,i=this.column.get("name");return e.text(this.formatter.fromRaw(t.get(i),t)),e.addClass(i),this.updateStateClassesMaybe(),this.delegateEvents(),this},enterEditMode:function(){var e=this.model,t=this.column;a.callByNeed(t.editable(),t,e)&&(this.currentEditor=new this.editor({column:this.column,model:this.model,formatter:this.formatter}),e.trigger("backgrid:edit",e,t,this,this.currentEditor),this.undelegateEvents(),this.$el.empty(),this.$el.append(this.currentEditor.$el),this.currentEditor.render(),this.$el.addClass("editor"),e.trigger("backgrid:editing",e,t,this,this.currentEditor))},renderError:function(e,t){null!=t&&t.get("name")!=this.column.get("name")||this.$el.addClass("error")},exitEditMode:function(){this.$el.removeClass("error"),this.currentEditor.remove(),this.stopListening(this.currentEditor),delete this.currentEditor,this.$el.removeClass("editor"),this.render()},remove:function(){return this.currentEditor&&(this.currentEditor.remove.apply(this.currentEditor,arguments),delete this.currentEditor),y.__super__.remove.apply(this,arguments)}}),b=a.StringCell=y.extend({className:"string-cell",formatter:f}),w=a.UriCell=y.extend({className:"uri-cell",title:null,target:"_blank",initialize:function(e){w.__super__.initialize.apply(this,arguments),this.title=e.title||this.title,this.target=e.target||this.target},render:function(){this.$el.empty();var e=this.model.get(this.column.get("name")),t=this.formatter.fromRaw(e,this.model);return this.$el.append(o("<a>",{tabIndex:-1,href:e,title:this.title||t,target:this.target}).text(t)),this.delegateEvents(),this}}),x=(a.EmailCell=b.extend({className:"email-cell",formatter:m,render:function(){this.$el.empty();var e=this.model,t=this.formatter.fromRaw(e.get(this.column.get("name")),e);return this.$el.append(o("<a>",{tabIndex:-1,href:"mailto:"+t,title:t}).text(t)),this.delegateEvents(),this}}),a.NumberCell=y.extend({className:"number-cell",decimals:c.prototype.defaults.decimals,decimalSeparator:c.prototype.defaults.decimalSeparator,orderSeparator:c.prototype.defaults.orderSeparator,formatter:c,initialize:function(e){x.__super__.initialize.apply(this,arguments);var t=this.formatter;t.decimals=this.decimals,t.decimalSeparator=this.decimalSeparator,t.orderSeparator=this.orderSeparator}})),_=(a.IntegerCell=x.extend({className:"integer-cell",decimals:0}),a.PercentCell=x.extend({className:"percent-cell",multiplier:u.prototype.defaults.multiplier,symbol:u.prototype.defaults.symbol,formatter:u,initialize:function(){_.__super__.initialize.apply(this,arguments);var e=this.formatter;e.multiplier=this.multiplier,e.symbol=this.symbol}})),C=a.DatetimeCell=y.extend({className:"datetime-cell",includeDate:d.prototype.defaults.includeDate,includeTime:d.prototype.defaults.includeTime,includeMilli:d.prototype.defaults.includeMilli,formatter:d,initialize:function(t){C.__super__.initialize.apply(this,arguments);var i=this.formatter;i.includeDate=this.includeDate,i.includeTime=this.includeTime,i.includeMilli=this.includeMilli;var n=this.includeDate?"YYYY-MM-DD":"";n+=this.includeDate&&this.includeTime?"T":"",n+=this.includeTime?"HH:mm:ss":"",n+=this.includeTime&&this.includeMilli?".SSS":"",this.editor=this.editor.extend({attributes:e.extend({},this.editor.prototype.attributes,this.editor.attributes,{placeholder:n})})}}),E=(a.DateCell=C.extend({className:"date-cell",includeTime:!1}),a.TimeCell=C.extend({className:"time-cell",includeDate:!1}),a.BooleanCellEditor=g.extend({tagName:"input",attributes:{tabIndex:-1,type:"checkbox"},events:{mousedown:function(){this.mouseDown=!0},blur:"enterOrExitEditMode",mouseup:function(){this.mouseDown=!1},change:"saveOrCancel",keydown:"saveOrCancel"},render:function(){var e=this.model;return this.$el.prop("checked",this.formatter.fromRaw(e.get(this.column.get("name")),e)),this},enterOrExitEditMode:function(e){if(!this.mouseDown){var t=this.model;t.trigger("backgrid:edited",t,this.column,new l(e))}},saveOrCancel:function(e){var t=this.model,i=this.column,n=this.formatter,r=new l(e);if(r.passThru()&&"change"!=e.type)return!0;r.cancel()&&(e.stopPropagation(),t.trigger("backgrid:edited",t,i,r));var s=this.$el;if(r.save()||r.moveLeft()||r.moveRight()||r.moveUp()||r.moveDown()){e.preventDefault(),e.stopPropagation();var o=n.toRaw(s.prop("checked"),t);t.set(i.get("name"),o),t.trigger("backgrid:edited",t,i,r)}else if("change"==e.type){var o=n.toRaw(s.prop("checked"),t);t.set(i.get("name"),o),s.focus()}}})),T=(a.BooleanCell=y.extend({className:"boolean-cell",editor:E,events:{click:"enterEditMode"},render:function(){this.$el.empty();var e=this.model,t=this.column,i=a.callByNeed(t.editable(),t,e);return this.$el.append(o("<input>",{tabIndex:-1,type:"checkbox",checked:this.formatter.fromRaw(e.get(t.get("name")),e),disabled:!i})),this.delegateEvents(),this}}),a.SelectCellEditor=g.extend({tagName:"select",events:{change:"save",blur:"close",keydown:"close"},template:e.template('<option value="<%- value %>" <%= selected ? \'selected="selected"\' : "" %>><%- text %></option>',null,{variable:null,evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g}),setOptionValues:function(t){this.optionValues=t,this.optionValues=e.result(this,"optionValues")},setMultiple:function(e){this.multiple=e,this.$el.prop("multiple",e)},_renderOptions:function(t,i){for(var n="",r=0;t.length>r;r++)n+=this.template({text:t[r][0],value:t[r][1],selected:e.indexOf(i,t[r][1])>-1});return n},render:function(){this.$el.empty();var t=e.result(this,"optionValues"),i=this.model,n=this.formatter.fromRaw(i.get(this.column.get("name")),i);if(!e.isArray(t))throw new TypeError("optionValues must be an array");for(var r=null,s=null,r=null,a=null,l=null,h=0;t.length>h;h++){var r=t[h];if(e.isArray(r))s=r[0],r=r[1],this.$el.append(this.template({text:s,value:r,selected:e.indexOf(n,r)>-1}));else{if(!e.isObject(r))throw new TypeError("optionValues elements must be a name-value pair or an object hash of { name: 'optgroup label', value: [option name-value pairs] }");a=r.name,l=o("<optgroup></optgroup>",{label:a}),l.append(this._renderOptions.call(this,r.values,n)),this.$el.append(l)}}return this.delegateEvents(),this},save:function(e){var t=this.model;t.set(this.column.get("name"),this.formatter.toRaw(this.$el.val(),t))},close:function(e){var t=this.model,i=this.column,n=new l(e);n.cancel()?(e.stopPropagation(),t.trigger("backgrid:edited",t,i,new l(e))):(n.save()||n.moveLeft()||n.moveRight()||n.moveUp()||n.moveDown()||"blur"==e.type)&&(e.preventDefault(),e.stopPropagation(),this.save(e),t.trigger("backgrid:edited",t,i,new l(e)))}})),k=a.SelectCell=y.extend({className:"select-cell",editor:T,multiple:!1,formatter:p,optionValues:void 0,delimiter:", ",initialize:function(e){k.__super__.initialize.apply(this,arguments),this.listenTo(this.model,"backgrid:edit",function(e,t,i,n){t.get("name")==this.column.get("name")&&(n.setOptionValues(this.optionValues),n.setMultiple(this.multiple))})},render:function(){this.$el.empty();var t=e.result(this,"optionValues"),i=this.model,n=this.formatter.fromRaw(i.get(this.column.get("name")),i),r=[];try{if(!e.isArray(t)||e.isEmpty(t))throw new TypeError;for(var s=0;n.length>s;s++)for(var o=n[s],a=0;t.length>a;a++){var l=t[a];if(e.isArray(l)){var h=l[0],l=l[1];l==o&&r.push(h)}else{if(!e.isObject(l))throw new TypeError;for(var c=l.values,u=0;c.length>u;u++){var d=c[u];d[1]==o&&r.push(d[0])}}}this.$el.append(r.join(this.delimiter))}catch(e){if(e instanceof TypeError)throw new TypeError("'optionValues' must be of type {Array.<Array>|Array.<{name: string, values: Array.<Array>}>}");throw e}return this.delegateEvents(),this}}),R=a.Column=t.Model.extend({defaults:{name:void 0,label:void 0,sortable:!0,editable:!0,renderable:!0,formatter:void 0,sortType:"cycle",sortValue:void 0,direction:null,cell:void 0,headerCell:void 0},initialize:function(){this.has("label")||this.set({label:this.get("name")},{silent:!0});var e=a.resolveNameToClass(this.get("headerCell"),"HeaderCell");this.set({cell:a.resolveNameToClass(this.get("cell"),"Cell"),headerCell:e},{silent:!0})},sortValue:function(){var t=this.get("sortValue");return e.isString(t)?this[t]:e.isFunction(t)?t:function(e,t){return e.get(t)}}});e.each(["sortable","renderable","editable"],function(t){R.prototype[t]=function(){var i=this.get(t);return e.isString(i)?this[i]:e.isFunction(i)?i:!!i}});var S=a.Columns=t.Collection.extend({model:R}),$=a.Row=t.View.extend({tagName:"tr",initialize:function(e){var i=this.columns=e.columns;i instanceof t.Collection||(i=this.columns=new S(i));for(var n=this.cells=[],r=0;i.length>r;r++)n.push(this.makeCell(i.at(r),e));this.listenTo(i,"add",function(t,i){var r=i.indexOf(t),s=this.makeCell(t,e);n.splice(r,0,s);var o=this.$el;0===r?o.prepend(s.render().$el):r===i.length-1?o.append(s.render().$el):o.children().eq(r).before(s.render().$el)}),this.listenTo(i,"remove",function(e,t,i){n[i.index].remove(),n.splice(i.index,1)})},makeCell:function(e){return new(e.get("cell"))({column:e,model:this.model})},render:function(){this.$el.empty();for(var e=document.createDocumentFragment(),t=0;this.cells.length>t;t++)e.appendChild(this.cells[t].render().el);return this.el.appendChild(e),this.delegateEvents(),this},remove:function(){for(var e=0;this.cells.length>e;e++){var i=this.cells[e];i.remove.apply(i,arguments)}return t.View.prototype.remove.apply(this,arguments)}}),N=a.EmptyRow=t.View.extend({tagName:"tr",emptyText:null,initialize:function(e){this.emptyText=e.emptyText,this.columns=e.columns},render:function(){this.$el.empty();var t=document.createElement("td");t.setAttribute("colspan",this.columns.length);var i=document.createElement("span");return i.innerHTML=e.result(this,"emptyText"),t.appendChild(i),this.el.className="empty",this.el.appendChild(t),this}}),M=a.HeaderCell=t.View.extend({tagName:"th",events:{"click button":"onClick"},initialize:function(e){(this.column=e.column)instanceof R||(this.column=new R(this.column));var t=this.column,i=this.collection,n=this.$el;this.listenTo(t,"change:editable change:sortable change:renderable",function(e){var t=e.changedAttributes();for(var i in t)t.hasOwnProperty(i)&&n.toggleClass(i,t[i])}),this.listenTo(t,"change:direction",this.setCellDirection),this.listenTo(t,"change:name change:label",this.render),a.callByNeed(t.editable(),t,i)&&n.addClass("editable"),a.callByNeed(t.sortable(),t,i)&&n.addClass("sortable"),a.callByNeed(t.renderable(),t,i)&&n.addClass("renderable"),this.listenTo(i.fullCollection||i,"backgrid:sorted",this.removeCellDirection)},removeCellDirection:function(){this.$el.removeClass("ascending").removeClass("descending"),this.column.set("direction",null)},setCellDirection:function(e,t){this.$el.removeClass("ascending").removeClass("descending"),e.cid==this.column.cid&&this.$el.addClass(t)},onClick:function(e){e.preventDefault();var t=this.column,i=this.collection,n="backgrid:sort";a.callByNeed(t.sortable(),t,this.collection)&&("toggle"===t.get("sortType")?function(e,r){"ascending"===t.get("direction")?i.trigger(n,r,"descending"):i.trigger(n,r,"ascending")}(0,t):function(e,r){"ascending"===t.get("direction")?i.trigger(n,r,"descending"):"descending"===t.get("direction")?i.trigger(n,r,null):i.trigger(n,r,"ascending")}(0,t))},render:function(){this.$el.empty();var e,t=this.column,i=a.callByNeed(t.sortable(),t,this.collection);return e=i?o("<button>").text(t.get("label")).append("<span class='sort-caret' aria-hidden='true'></span>"):document.createTextNode(t.get("label")),this.$el.append(e),this.$el.addClass(t.get("name")),this.$el.addClass(t.get("direction")),this.delegateEvents(),this}}),I=(a.HeaderRow=a.Row.extend({initialize:function(){a.Row.prototype.initialize.apply(this,arguments)},makeCell:function(e,t){var i=e.get("headerCell")||t.headerCell||M;return i=new i({column:e,collection:this.collection})}}),a.Header=t.View.extend({tagName:"thead",initialize:function(e){this.columns=e.columns,this.columns instanceof t.Collection||(this.columns=new S(this.columns)),this.row=new a.HeaderRow({columns:this.columns,collection:this.collection})},render:function(){return this.$el.append(this.row.render().$el),this.delegateEvents(),this},remove:function(){return this.row.remove.apply(this.row,arguments),t.View.prototype.remove.apply(this,arguments)}})),D=a.Body=t.View.extend({tagName:"tbody",initialize:function(e){this.columns=e.columns,this.columns instanceof t.Collection||(this.columns=new S(this.columns)),this.row=e.row||this.row||$,this.rows=this.collection.map(function(e){return new this.row({columns:this.columns,model:e})},this),this.emptyText=e.emptyText,this._unshiftEmptyRowMayBe();var i=this.collection;this.listenTo(i,"add",this.insertRow),this.listenTo(i,"remove",this.removeRow),this.listenTo(i,"sort",this.refresh),this.listenTo(i,"reset",this.refresh),this.listenTo(i,"backgrid:sort",this.sort),this.listenTo(i,"backgrid:edited",this.moveToNextCell),this.listenTo(this.columns,"add remove",this.updateEmptyRow)},_unshiftEmptyRowMayBe:function(){if(0===this.rows.length&&null!=this.emptyText)return this.emptyRow=new N({emptyText:this.emptyText,columns:this.columns}),this.rows.unshift(this.emptyRow),!0},insertRow:function(e,i,n){if(this.rows[0]instanceof N&&this.rows.pop().remove(),!(i instanceof t.Collection||n))return void this.collection.add(e,n=i);var r=new this.row({columns:this.columns,model:e}),s=i.indexOf(e);this.rows.splice(s,0,r);var o=this.$el,a=o.children(),l=r.render().$el;return a.length>s?a.eq(s).before(l):o.append(l),this},removeRow:function(t,i,n){return n?((e.isUndefined(n.render)||n.render)&&this.rows[n.index].remove(),this.rows.splice(n.index,1),this._unshiftEmptyRowMayBe()&&this.render(),this):(this.collection.remove(t,n=i),void(this._unshiftEmptyRowMayBe()&&this.render()))},updateEmptyRow:function(){null!=this.emptyRow&&this.emptyRow.render()},refresh:function(){for(var e=0;this.rows.length>e;e++)this.rows[e].remove();return this.rows=this.collection.map(function(e){return new this.row({columns:this.columns,model:e})},this),this._unshiftEmptyRowMayBe(),this.render(),this.collection.trigger("backgrid:refresh",this),this},render:function(){this.$el.empty();for(var e=document.createDocumentFragment(),t=0;this.rows.length>t;t++){e.appendChild(this.rows[t].render().el)}return this.el.appendChild(e),this.delegateEvents(),this},remove:function(){for(var e=0;this.rows.length>e;e++){var i=this.rows[e];i.remove.apply(i,arguments)}return t.View.prototype.remove.apply(this,arguments)},sort:function(i,n){if(!e.contains(["ascending","descending",null],n))throw new RangeError('direction must be one of "ascending", "descending" or `null`');e.isString(i)&&(i=this.columns.findWhere({name:i}));var r,s=this.collection;r="ascending"===n?-1:"descending"===n?1:null;var o=this.makeComparator(i.get("name"),r,r?i.sortValue():function(e){return 1*e.cid.replace("c","")});return t.PageableCollection&&s instanceof t.PageableCollection?(s.setSorting(r&&i.get("name"),r,{sortValue:i.sortValue()}),s.fullCollection?(null==s.fullCollection.comparator&&(s.fullCollection.comparator=o),s.fullCollection.sort(),s.trigger("backgrid:sorted",i,n,s),i.set("direction",n)):s.fetch({reset:!0,success:function(){s.trigger("backgrid:sorted",i,n,s),i.set("direction",n)}})):(s.comparator=o,s.sort(),s.trigger("backgrid:sorted",i,n,s),i.set("direction",n)),this},makeComparator:function(e,t,i){return function(n,r){var s,o=i(n,e),a=i(r,e);return 1===t&&(s=o,o=a,a=s),o===a?0:a>o?-1:1}},moveToNextCell:function(e,t,i){var n,r,s,o,l,h=this.collection.indexOf(e),c=this.columns.indexOf(t);if(-1===c)return this;if(this.rows[h].cells[c].exitEditMode(),i.moveUp()||i.moveDown()||i.moveLeft()||i.moveRight()||i.save()){var u=this.columns.length,d=u*this.collection.length;if(i.moveUp()||i.moveDown()){o=h+(i.moveUp()?-1:1);var f=this.rows[o];f?(n=f.cells[c],a.callByNeed(n.column.editable(),n.column,e)&&(n.enterEditMode(),e.trigger("backgrid:next",o,c,!1))):e.trigger("backgrid:next",o,c,!0)}else if(i.moveLeft()||i.moveRight()){for(var m=i.moveRight(),p=h*u+c+(m?1:-1);p>=0&&d>p;m?p++:p--)if(o=~~(p/u),l=p-o*u,n=this.rows[o].cells[l],r=a.callByNeed(n.column.renderable(),n.column,n.model),s=a.callByNeed(n.column.editable(),n.column,e),r&&s){n.enterEditMode(),e.trigger("backgrid:next",o,l,!1);break}p==d&&e.trigger("backgrid:next",~~(p/u),p-o*u,!0)}}return this}});a.Footer=t.View.extend({tagName:"tfoot",initialize:function(e){(this.columns=e.columns)instanceof t.Collection||(this.columns=new a.Columns(this.columns))}}),a.Grid=t.View.extend({tagName:"table",className:"backgrid",header:I,body:D,footer:null,initialize:function(i){i.columns instanceof t.Collection||(i.columns=new S(i.columns||this.columns)),this.columns=i.columns,this.caption=i.caption;var n=e.omit(i,["el","id","attributes","className","tagName","events"]);this.body=i.body||this.body,this.body=new this.body(n),this.header=i.header||this.header,this.header&&(this.header=new this.header(n)),this.footer=i.footer||this.footer,this.footer&&(this.footer=new this.footer(n)),this.listenTo(this.columns,"reset",function(){this.header&&(this.header=new(this.header.remove().constructor)(n)),this.body=new(this.body.remove().constructor)(n),this.footer&&(this.footer=new(this.footer.remove().constructor)(n)),this.render()})},insertRow:function(){return this.body.insertRow.apply(this.body,arguments),this},removeRow:function(){return this.body.removeRow.apply(this.body,arguments),this},insertColumn:function(){return this.columns.add.apply(this.columns,arguments),this},removeColumn:function(){return this.columns.remove.apply(this.columns,arguments),this},sort:function(){return this.body.sort.apply(this.body,arguments),this},render:function(){return this.$el.empty(),this.caption&&this.$el.append(o("<caption>").text(this.caption)),this.header&&this.$el.append(this.header.render().$el),this.footer&&this.$el.append(this.footer.render().$el),this.$el.append(this.body.render().$el),this.delegateEvents(),this.trigger("backgrid:rendered",this),this},remove:function(){return this.header&&this.header.remove.apply(this.header,arguments),this.body.remove.apply(this.body,arguments),this.footer&&this.footer.remove.apply(this.footer,arguments),t.View.prototype.remove.apply(this,arguments)}});return a})},,,function(e,t,i){"use strict";(function(e){i(8);var t=i(4),n=function(e){return e&&e.__esModule?e:{default:e}}(t);i(9);var r={};window.app=r,r.Employee=Backbone.Model.extend({defaults:{name:"",position:"",age:18,gender:"m"}}),r.EmployeeList=Backbone.Collection.extend({model:r.Employee,url:location.href+"/employees",parse:function(e){return e.data}}),r.employeesList=new r.EmployeeList,console.log(location),console.log(r.employeesList.url);var s=[{name:"name",label:"Имя",editable:!1,cell:"string"},{name:"gender",label:"Пол",editable:!1,cell:"string"},{name:"age",label:"Возраст",editable:!1,cell:n.default.IntegerCell.extend({orderSeparator:""})},{name:"position",label:"Должность",editable:!1,cell:"string"},{name:"",label:"",editable:!1,cell:n.default.Cell.extend({render:function(){return this.$el.html('<button class="edit-item" data-name="'+this.model.attributes.name+'"><span class="glyphicon glyphicon-edit"></span></button>'),this}})}],o=new n.default.Grid({className:"employees-grid",columns:s,collection:r.employeesList});e("#employeesGrid").append(o.render().el);var a=new n.default.Extension.ClientSideFilter({className:"employees-search",collection:r.employeesList,fields:["name"],placeholder:"Введите имя для поиска",wait:150});e("#name-filter").prepend(a.render().el),r.employeesList.fetch({reset:!0}),e("#employeesGrid").on("click",".edit-item",function(){e("#editEmployeeModal").modal("show")})}).call(t,i(0))},function(e,t){},function(e,t,i){var n,r,s;!function(o,a){r=[i(1),i(10),i(4)],n=a,void 0!==(s="function"==typeof n?n.apply(t,r):n)&&(e.exports=s)}(0,function(e,t,i,n){"use strict";var r={},s=r.ServerSideFilter=i.Extension.ServerSideFilter=t.View.extend({tagName:"form",className:"backgrid-filter form-search",template:function(e){return'<span class="search">&nbsp;</span><input type="search" '+(e.placeholder?'placeholder="'+e.placeholder+'"':"")+' name="'+e.name+'" '+(e.value?'value="'+e.value+'"':"")+'/><a class="clear" data-backgrid-action="clear" href="#">&times;</a>'},events:{"keyup input[type=search]":"showClearButtonMaybe","click a[data-backgrid-action=clear]":"clear",submit:"search"},name:"q",value:null,placeholder:null,initialize:function(e){s.__super__.initialize.apply(this,arguments),this.name=e.name||this.name,this.value=e.value||this.value,this.placeholder=e.placeholder||this.placeholder,this.template=e.template||this.template;var i=this.collection,n=this;t.PageableCollection&&i instanceof t.PageableCollection&&"server"==i.mode&&(i.queryParams[this.name]=function(){return n.query()||null})},clearSearchBox:function(){this.value=null,this.searchBox().val(null),this.showClearButtonMaybe()},showClearButtonMaybe:function(){var e=this.clearButton();this.query()?e.show():e.hide()},searchBox:function(){return this.$el.find("input[type=search]")},clearButton:function(){return this.$el.find("a[data-backgrid-action=clear]")},query:function(){return this.value=this.searchBox().val()},search:function(e){e&&e.preventDefault();var i={},n=this.query();n&&(i[this.name]=n);var r=this.collection;t.PageableCollection&&r instanceof t.PageableCollection?r.getFirstPage({data:i,reset:!0,fetch:!0}):r.fetch({data:i,reset:!0})},clear:function(e){e&&e.preventDefault(),this.clearSearchBox();var i=this.collection;t.PageableCollection&&i instanceof t.PageableCollection?i.getFirstPage({reset:!0,fetch:!0}):i.fetch({reset:!0})},render:function(){return this.$el.empty().append(this.template({name:this.name,placeholder:this.placeholder,value:this.value})),this.showClearButtonMaybe(),this.delegateEvents(),this}}),o=r.ClientSideFilter=i.Extension.ClientSideFilter=s.extend({events:e.extend({},s.prototype.events,{"click a[data-backgrid-action=clear]":function(e){e.preventDefault(),this.clear()},"keydown input[type=search]":"search",submit:function(e){e.preventDefault(),this.search()}}),fields:null,wait:149,initialize:function(t){o.__super__.initialize.apply(this,arguments),this.fields=t.fields||this.fields,this.wait=t.wait||this.wait,this._debounceMethods(["search","clear"]);var i=this.collection=this.collection.fullCollection||this.collection,n=this.shadowCollection=i.clone();this.listenTo(i,"add",function(e,t,i){n.add(e,i)}),this.listenTo(i,"remove",function(e,t,i){n.remove(e,i)}),this.listenTo(i,"sort",function(e){this.query()||n.reset(e.models)}),this.listenTo(i,"reset",function(t,i){i=e.extend({reindex:!0},i||{}),i.reindex&&null==i.from&&null==i.to&&n.reset(t.models)})},_debounceMethods:function(t){e.isString(t)&&(t=[t]),this.undelegateEvents();for(var i=0,n=t.length;n>i;i++){var r=t[i];this[r]=e.debounce(this[r],this.wait)}this.delegateEvents()},makeRegExp:function(e){return RegExp(e.trim().split(/\s+/).join("|"),"i")},makeMatcher:function(e){var t=this.makeRegExp(e);return function(e){for(var i=this.fields||e.keys(),n=0,r=i.length;r>n;n++)if(t.test(e.get(i[n])+""))return!0;return!1}},search:function(){var t=e.bind(this.makeMatcher(this.query()),this),i=this.collection;i.pageableCollection&&i.pageableCollection.getFirstPage({silent:!0}),i.reset(this.shadowCollection.filter(t),{reindex:!1})},clear:function(){this.clearSearchBox();var e=this.collection;e.pageableCollection&&e.pageableCollection.getFirstPage({silent:!0}),e.reset(this.shadowCollection.models,{reindex:!1})}}),a=r.LunrFilter=i.Extension.LunrFilter=o.extend({ref:"id",fields:null,initialize:function(e){a.__super__.initialize.apply(this,arguments),this.ref=e.ref||this.ref;var t=this.collection=this.collection.fullCollection||this.collection;this.listenTo(t,"add",this.addToIndex),this.listenTo(t,"remove",this.removeFromIndex),this.listenTo(t,"reset",this.resetIndex),this.listenTo(t,"change",this.updateIndex),this.resetIndex(t)},resetIndex:function(t,i){if(i=e.extend({reindex:!0},i||{}),i.reindex){var r=this;this.index=n(function(){e.each(r.fields,function(e,t){this.field(t,e),this.ref(r.ref)},this)}),t.each(function(e){this.addToIndex(e)},this)}},addToIndex:function(e){var t=this.index,i=e.toJSON();t.documentStore.has(i[this.ref])?t.update(i):t.add(i)},removeFromIndex:function(e){var t=this.index,i=e.toJSON();t.documentStore.has(i[this.ref])&&t.remove(i)},updateIndex:function(t){var i=t.changedAttributes();i&&!e.isEmpty(e.intersection(e.keys(this.fields),e.keys(i)))&&this.index.update(t.toJSON())},search:function(){var e=this.collection;if(!this.query())return void e.reset(this.shadowCollection.models,{reindex:!1});for(var t=this.index.search(this.query()),i=[],n=0;t.length>n;n++){i.push(this.shadowCollection.get(t[n].ref))}e.pageableCollection&&e.pageableCollection.getFirstPage({silent:!0}),e.reset(i,{reindex:!1})}});return r})},function(e,t,i){(function(n){var r,s;!function(o){var a="object"==typeof self&&self.self==self&&self||"object"==typeof n&&n.global==n&&n;r=[i(1),i(0),t],void 0!==(s=function(e,t,i){a.Backbone=o(a,i,e,t)}.apply(t,r))&&(e.exports=s)}(function(e,t,i,n){var r=e.Backbone,s=Array.prototype.slice;t.VERSION="1.2.3",t.$=n,t.noConflict=function(){return e.Backbone=r,this},t.emulateHTTP=!1,t.emulateJSON=!1;var o=function(e,t,n){switch(e){case 1:return function(){return i[t](this[n])};case 2:return function(e){return i[t](this[n],e)};case 3:return function(e,r){return i[t](this[n],l(e,this),r)};case 4:return function(e,r,s){return i[t](this[n],l(e,this),r,s)};default:return function(){var e=s.call(arguments);return e.unshift(this[n]),i[t].apply(i,e)}}},a=function(e,t,n){i.each(t,function(t,r){i[r]&&(e.prototype[r]=o(t,r,n))})},l=function(e,t){return i.isFunction(e)?e:i.isObject(e)&&!t._isModel(e)?h(e):i.isString(e)?function(t){return t.get(e)}:e},h=function(e){var t=i.matches(e);return function(e){return t(e.attributes)}},c=t.Events={},u=/\s+/,d=function(e,t,n,r,s){var o,a=0;if(n&&"object"==typeof n){void 0!==r&&"context"in s&&void 0===s.context&&(s.context=r);for(o=i.keys(n);o.length>a;a++)t=d(e,t,o[a],n[o[a]],s)}else if(n&&u.test(n))for(o=n.split(u);o.length>a;a++)t=e(t,o[a],r,s);else t=e(t,n,r,s);return t};c.on=function(e,t,i){return f(this,e,t,i)};var f=function(e,t,i,n,r){if(e._events=d(m,e._events||{},t,i,{context:n,ctx:e,listening:r}),r){(e._listeners||(e._listeners={}))[r.id]=r}return e};c.listenTo=function(e,t,n){if(!e)return this;var r=e._listenId||(e._listenId=i.uniqueId("l")),s=this._listeningTo||(this._listeningTo={}),o=s[r];if(!o){o=s[r]={obj:e,objId:r,id:this._listenId||(this._listenId=i.uniqueId("l")),listeningTo:s,count:0}}return f(e,t,n,this,o),this};var m=function(e,t,i,n){if(i){var r=e[t]||(e[t]=[]),s=n.context,o=n.ctx,a=n.listening;a&&a.count++,r.push({callback:i,context:s,ctx:s||o,listening:a})}return e};c.off=function(e,t,i){return this._events?(this._events=d(p,this._events,e,t,{context:i,listeners:this._listeners}),this):this},c.stopListening=function(e,t,n){var r=this._listeningTo;if(!r)return this;for(var s=e?[e._listenId]:i.keys(r),o=0;s.length>o;o++){var a=r[s[o]];if(!a)break;a.obj.off(t,n,this)}return i.isEmpty(r)&&(this._listeningTo=void 0),this};var p=function(e,t,n,r){if(e){var s,o=0,a=r.context,l=r.listeners;if(t||n||a){for(var h=t?[t]:i.keys(e);h.length>o;o++){t=h[o];var c=e[t];if(!c)break;for(var u=[],d=0;c.length>d;d++){var f=c[d];n&&n!==f.callback&&n!==f.callback._callback||a&&a!==f.context?u.push(f):(s=f.listening)&&0==--s.count&&(delete l[s.id],delete s.listeningTo[s.objId])}u.length?e[t]=u:delete e[t]}return i.size(e)?e:void 0}for(var m=i.keys(l);m.length>o;o++)s=l[m[o]],delete l[s.id],delete s.listeningTo[s.objId]}};c.once=function(e,t,n){return this.on(d(g,{},e,t,i.bind(this.off,this)),void 0,n)},c.listenToOnce=function(e,t,n){return this.listenTo(e,d(g,{},t,n,i.bind(this.stopListening,this,e)))};var g=function(e,t,n,r){if(n){var s=e[t]=i.once(function(){r(t,s),n.apply(this,arguments)});s._callback=n}return e};c.trigger=function(e){if(!this._events)return this;for(var t=Math.max(0,arguments.length-1),i=Array(t),n=0;t>n;n++)i[n]=arguments[n+1];return d(v,this._events,e,void 0,i),this};var v=function(e,t,i,n){if(e){var r=e[t],s=e.all;r&&s&&(s=s.slice()),r&&y(r,n),s&&y(s,[t].concat(n))}return e},y=function(e,t){var i,n=-1,r=e.length,s=t[0],o=t[1],a=t[2];switch(t.length){case 0:for(;++n<r;)(i=e[n]).callback.call(i.ctx);return;case 1:for(;++n<r;)(i=e[n]).callback.call(i.ctx,s);return;case 2:for(;++n<r;)(i=e[n]).callback.call(i.ctx,s,o);return;case 3:for(;++n<r;)(i=e[n]).callback.call(i.ctx,s,o,a);return;default:for(;++n<r;)(i=e[n]).callback.apply(i.ctx,t);return}};c.bind=c.on,c.unbind=c.off,i.extend(t,c);var b=t.Model=function(e,t){var n=e||{};t||(t={}),this.cid=i.uniqueId(this.cidPrefix),this.attributes={},t.collection&&(this.collection=t.collection),t.parse&&(n=this.parse(n,t)||{}),n=i.defaults({},n,i.result(this,"defaults")),this.set(n,t),this.changed={},this.initialize.apply(this,arguments)};i.extend(b.prototype,c,{changed:null,validationError:null,idAttribute:"id",cidPrefix:"c",initialize:function(){},toJSON:function(e){return i.clone(this.attributes)},sync:function(){return t.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return i.escape(this.get(e))},has:function(e){return null!=this.get(e)},matches:function(e){return!!i.iteratee(e,this)(this.attributes)},set:function(e,t,n){if(null==e)return this;var r;if("object"==typeof e?(r=e,n=t):(r={})[e]=t,n||(n={}),!this._validate(r,n))return!1;var s=n.unset,o=n.silent,a=[],l=this._changing;this._changing=!0,l||(this._previousAttributes=i.clone(this.attributes),this.changed={});var h=this.attributes,c=this.changed,u=this._previousAttributes;for(var d in r)t=r[d],i.isEqual(h[d],t)||a.push(d),i.isEqual(u[d],t)?delete c[d]:c[d]=t,s?delete h[d]:h[d]=t;if(this.id=this.get(this.idAttribute),!o){a.length&&(this._pending=n);for(var f=0;a.length>f;f++)this.trigger("change:"+a[f],this,h[a[f]],n)}if(l)return this;if(!o)for(;this._pending;)n=this._pending,this._pending=!1,this.trigger("change",this,n);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,i.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var n in this.attributes)t[n]=void 0;return this.set(t,i.extend({},e,{unset:!0}))},hasChanged:function(e){return null==e?!i.isEmpty(this.changed):i.has(this.changed,e)},changedAttributes:function(e){if(!e)return!!this.hasChanged()&&i.clone(this.changed);var t=this._changing?this._previousAttributes:this.attributes,n={};for(var r in e){var s=e[r];i.isEqual(t[r],s)||(n[r]=s)}return!!i.size(n)&&n},previous:function(e){return null!=e&&this._previousAttributes?this._previousAttributes[e]:null},previousAttributes:function(){return i.clone(this._previousAttributes)},fetch:function(e){e=i.extend({parse:!0},e);var t=this,n=e.success;return e.success=function(i){var r=e.parse?t.parse(i,e):i;if(!t.set(r,e))return!1;n&&n.call(e.context,t,i,e),t.trigger("sync",t,i,e)},O(this,e),this.sync("read",this,e)},save:function(e,t,n){var r;null==e||"object"==typeof e?(r=e,n=t):(r={})[e]=t,n=i.extend({validate:!0,parse:!0},n);var s=n.wait;if(r&&!s){if(!this.set(r,n))return!1}else if(!this._validate(r,n))return!1;var o=this,a=n.success,l=this.attributes;n.success=function(e){o.attributes=l;var t=n.parse?o.parse(e,n):e;if(s&&(t=i.extend({},r,t)),t&&!o.set(t,n))return!1;a&&a.call(n.context,o,e,n),o.trigger("sync",o,e,n)},O(this,n),r&&s&&(this.attributes=i.extend({},l,r));var h=this.isNew()?"create":n.patch?"patch":"update";"patch"!==h||n.attrs||(n.attrs=r);var c=this.sync(h,this,n);return this.attributes=l,c},destroy:function(e){e=e?i.clone(e):{};var t=this,n=e.success,r=e.wait,s=function(){t.stopListening(),t.trigger("destroy",t,t.collection,e)};e.success=function(i){r&&s(),n&&n.call(e.context,t,i,e),t.isNew()||t.trigger("sync",t,i,e)};var o=!1;return this.isNew()?i.defer(e.success):(O(this,e),o=this.sync("delete",this,e)),r||s(),o},url:function(){var e=i.result(this,"urlRoot")||i.result(this.collection,"url")||B();if(this.isNew())return e;var t=this.get(this.idAttribute);return e.replace(/[^\/]$/,"$&/")+encodeURIComponent(t)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(e){return this._validate({},i.defaults({validate:!0},e))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=i.extend({},this.attributes,e);var n=this.validationError=this.validate(e,t)||null;return!n||(this.trigger("invalid",this,n,i.extend(t,{validationError:n})),!1)}}),a(b,{keys:1,values:1,pairs:1,invert:1,pick:0,omit:0,chain:1,isEmpty:1},"attributes");var w=t.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),void 0!==t.comparator&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,i.extend({silent:!0},t))},x={add:!0,remove:!0,merge:!0},_={add:!0,remove:!1},C=function(e,t,i){i=Math.min(Math.max(i,0),e.length);for(var n=Array(e.length-i),r=t.length,s=0;n.length>s;s++)n[s]=e[s+i];for(s=0;r>s;s++)e[s+i]=t[s];for(s=0;n.length>s;s++)e[s+r+i]=n[s]};i.extend(w.prototype,c,{model:b,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return t.sync.apply(this,arguments)},add:function(e,t){return this.set(e,i.extend({merge:!1},t,_))},remove:function(e,t){t=i.extend({},t);var n=!i.isArray(e);e=n?[e]:i.clone(e);var r=this._removeModels(e,t);return!t.silent&&r&&this.trigger("update",this,t),n?r[0]:r},set:function(e,t){if(null!=e){t=i.defaults({},t,x),t.parse&&!this._isModel(e)&&(e=this.parse(e,t));var n=!i.isArray(e);e=n?[e]:e.slice();var r=t.at;null!=r&&(r=+r),0>r&&(r+=this.length+1);for(var s,o=[],a=[],l=[],h={},c=t.add,u=t.merge,d=t.remove,f=!1,m=this.comparator&&null==r&&!1!==t.sort,p=i.isString(this.comparator)?this.comparator:null,g=0;e.length>g;g++){s=e[g];var v=this.get(s);if(v){if(u&&s!==v){var y=this._isModel(s)?s.attributes:s;t.parse&&(y=v.parse(y,t)),v.set(y,t),m&&!f&&(f=v.hasChanged(p))}h[v.cid]||(h[v.cid]=!0,o.push(v)),e[g]=v}else c&&(s=e[g]=this._prepareModel(s,t))&&(a.push(s),this._addReference(s,t),h[s.cid]=!0,o.push(s))}if(d){for(g=0;this.length>g;g++)s=this.models[g],h[s.cid]||l.push(s);l.length&&this._removeModels(l,t)}var b=!1,w=!m&&c&&d;if(o.length&&w?(b=this.length!=o.length||i.some(this.models,function(e,t){return e!==o[t]}),this.models.length=0,C(this.models,o,0),this.length=this.models.length):a.length&&(m&&(f=!0),C(this.models,a,null==r?this.length:r),this.length=this.models.length),f&&this.sort({silent:!0}),!t.silent){for(g=0;a.length>g;g++)null!=r&&(t.index=r+g),s=a[g],s.trigger("add",s,this,t);(f||b)&&this.trigger("sort",this,t),(a.length||l.length)&&this.trigger("update",this,t)}return n?e[0]:e}},reset:function(e,t){t=t?i.clone(t):{};for(var n=0;this.models.length>n;n++)this._removeReference(this.models[n],t);return t.previousModels=this.models,this._reset(),e=this.add(e,i.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),e},push:function(e,t){return this.add(e,i.extend({at:this.length},t))},pop:function(e){return this.remove(this.at(this.length-1),e)},unshift:function(e,t){return this.add(e,i.extend({at:0},t))},shift:function(e){return this.remove(this.at(0),e)},slice:function(){return s.apply(this.models,arguments)},get:function(e){if(null!=e){var t=this.modelId(this._isModel(e)?e.attributes:e);return this._byId[e]||this._byId[t]||this._byId[e.cid]}},at:function(e){return 0>e&&(e+=this.length),this.models[e]},where:function(e,t){return this[t?"find":"filter"](e)},findWhere:function(e){return this.where(e,!0)},sort:function(e){var t=this.comparator;if(!t)throw Error("Cannot sort a set without a comparator");e||(e={});var n=t.length;return i.isFunction(t)&&(t=i.bind(t,this)),1===n||i.isString(t)?this.models=this.sortBy(t):this.models.sort(t),e.silent||this.trigger("sort",this,e),this},pluck:function(e){return i.invoke(this.models,"get",e)},fetch:function(e){e=i.extend({parse:!0},e);var t=e.success,n=this;return e.success=function(i){n[e.reset?"reset":"set"](i,e),t&&t.call(e.context,n,i,e),n.trigger("sync",n,i,e)},O(this,e),this.sync("read",this,e)},create:function(e,t){t=t?i.clone(t):{};var n=t.wait;if(!(e=this._prepareModel(e,t)))return!1;n||this.add(e,t);var r=this,s=t.success;return t.success=function(e,t,i){n&&r.add(e,i),s&&s.call(i.context,e,t,i)},e.save(null,t),e},parse:function(e,t){return e},clone:function(){return new this.constructor(this.models,{model:this.model,comparator:this.comparator})},modelId:function(e){return e[this.model.prototype.idAttribute||"id"]},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(this._isModel(e))return e.collection||(e.collection=this),e;t=t?i.clone(t):{},t.collection=this;var n=new this.model(e,t);return n.validationError?(this.trigger("invalid",this,n.validationError,t),!1):n},_removeModels:function(e,t){for(var i=[],n=0;e.length>n;n++){var r=this.get(e[n]);if(r){var s=this.indexOf(r);this.models.splice(s,1),this.length--,t.silent||(t.index=s,r.trigger("remove",r,this,t)),i.push(r),this._removeReference(r,t)}}return!!i.length&&i},_isModel:function(e){return e instanceof b},_addReference:function(e,t){this._byId[e.cid]=e;var i=this.modelId(e.attributes);null!=i&&(this._byId[i]=e),e.on("all",this._onModelEvent,this)},_removeReference:function(e,t){delete this._byId[e.cid];var i=this.modelId(e.attributes);null!=i&&delete this._byId[i],this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,i,n){if("add"!==e&&"remove"!==e||i===this){if("destroy"===e&&this.remove(t,n),"change"===e){var r=this.modelId(t.previousAttributes()),s=this.modelId(t.attributes);r!==s&&(null!=r&&delete this._byId[r],null!=s&&(this._byId[s]=t))}this.trigger.apply(this,arguments)}}}),a(w,{forEach:3,each:3,map:3,collect:3,reduce:4,foldl:4,inject:4,reduceRight:4,foldr:4,find:3,detect:3,filter:3,select:3,reject:3,every:3,all:3,some:3,any:3,include:3,includes:3,contains:3,invoke:0,max:3,min:3,toArray:1,size:1,first:3,head:3,take:3,initial:3,rest:3,tail:3,drop:3,last:3,without:0,difference:0,indexOf:3,shuffle:1,lastIndexOf:3,isEmpty:1,chain:1,sample:3,partition:3,groupBy:3,countBy:3,sortBy:3,indexBy:3},"models");var E=t.View=function(e){this.cid=i.uniqueId("view"),i.extend(this,i.pick(e,k)),this._ensureElement(),this.initialize.apply(this,arguments)},T=/^(\S+)\s*(.*)$/,k=["model","collection","el","id","attributes","className","tagName","events"];i.extend(E.prototype,c,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this._removeElement(),this.stopListening(),this},_removeElement:function(){this.$el.remove()},setElement:function(e){return this.undelegateEvents(),this._setElement(e),this.delegateEvents(),this},_setElement:function(e){this.$el=e instanceof t.$?e:t.$(e),this.el=this.$el[0]},delegateEvents:function(e){if(e||(e=i.result(this,"events")),!e)return this;this.undelegateEvents();for(var t in e){var n=e[t];if(i.isFunction(n)||(n=this[n]),n){var r=t.match(T);this.delegate(r[1],r[2],i.bind(n,this))}}return this},delegate:function(e,t,i){return this.$el.on(e+".delegateEvents"+this.cid,t,i),this},undelegateEvents:function(){return this.$el&&this.$el.off(".delegateEvents"+this.cid),this},undelegate:function(e,t,i){return this.$el.off(e+".delegateEvents"+this.cid,t,i),this},_createElement:function(e){return document.createElement(e)},_ensureElement:function(){if(this.el)this.setElement(i.result(this,"el"));else{var e=i.extend({},i.result(this,"attributes"));this.id&&(e.id=i.result(this,"id")),this.className&&(e.class=i.result(this,"className")),this.setElement(this._createElement(i.result(this,"tagName"))),this._setAttributes(e)}},_setAttributes:function(e){this.$el.attr(e)}}),t.sync=function(e,n,r){var s=R[e];i.defaults(r||(r={}),{emulateHTTP:t.emulateHTTP,emulateJSON:t.emulateJSON});var o={type:s,dataType:"json"};if(r.url||(o.url=i.result(n,"url")||B()),null!=r.data||!n||"create"!==e&&"update"!==e&&"patch"!==e||(o.contentType="application/json",o.data=JSON.stringify(r.attrs||n.toJSON(r))),r.emulateJSON&&(o.contentType="application/x-www-form-urlencoded",o.data=o.data?{model:o.data}:{}),r.emulateHTTP&&("PUT"===s||"DELETE"===s||"PATCH"===s)){o.type="POST",r.emulateJSON&&(o.data._method=s);var a=r.beforeSend;r.beforeSend=function(e){if(e.setRequestHeader("X-HTTP-Method-Override",s),a)return a.apply(this,arguments)}}"GET"===o.type||r.emulateJSON||(o.processData=!1);var l=r.error;r.error=function(e,t,i){r.textStatus=t,r.errorThrown=i,l&&l.call(r.context,e,t,i)};var h=r.xhr=t.ajax(i.extend(o,r));return n.trigger("request",n,h,r),h};var R={create:"POST",update:"PUT",patch:"PATCH",delete:"DELETE",read:"GET"};t.ajax=function(){return t.$.ajax.apply(t.$,arguments)};var S=t.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},$=/\((.*?)\)/g,N=/(\(\?)?:\w+/g,M=/\*\w+/g,I=/[\-{}\[\]+?.,\\\^$|#\s]/g;i.extend(S.prototype,c,{initialize:function(){},route:function(e,n,r){i.isRegExp(e)||(e=this._routeToRegExp(e)),i.isFunction(n)&&(r=n,n=""),r||(r=this[n]);var s=this;return t.history.route(e,function(i){var o=s._extractParameters(e,i);!1!==s.execute(r,o,n)&&(s.trigger.apply(s,["route:"+n].concat(o)),s.trigger("route",n,o),t.history.trigger("route",s,n,o))}),this},execute:function(e,t,i){e&&e.apply(this,t)},navigate:function(e,i){return t.history.navigate(e,i),this},_bindRoutes:function(){if(this.routes){this.routes=i.result(this,"routes");for(var e,t=i.keys(this.routes);null!=(e=t.pop());)this.route(e,this.routes[e])}},_routeToRegExp:function(e){return e=e.replace(I,"\\$&").replace($,"(?:$1)?").replace(N,function(e,t){return t?e:"([^/?]+)"}).replace(M,"([^?]*?)"),RegExp("^"+e+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(e,t){var n=e.exec(t).slice(1);return i.map(n,function(e,t){return t===n.length-1?e||null:e?decodeURIComponent(e):null})}});var D=t.History=function(){this.handlers=[],this.checkUrl=i.bind(this.checkUrl,this),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},P=/^[#\/]|\s+$/g,U=/^\/+|\/+$/g,F=/#.*$/;D.started=!1,i.extend(D.prototype,c,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root&&!this.getSearch()},matchRoot:function(){return this.decodeFragment(this.location.pathname).slice(0,this.root.length-1)+"/"===this.root},decodeFragment:function(e){return decodeURI(e.replace(/%25/g,"%2525"))},getSearch:function(){var e=this.location.href.replace(/#.*/,"").match(/\?.+/);return e?e[0]:""},getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getPath:function(){var e=this.decodeFragment(this.location.pathname+this.getSearch()).slice(this.root.length-1);return"/"===e.charAt(0)?e.slice(1):e},getFragment:function(e){return null==e&&(e=this._usePushState||!this._wantsHashChange?this.getPath():this.getHash()),e.replace(P,"")},start:function(e){if(D.started)throw Error("Backbone.history has already been started");if(D.started=!0,this.options=i.extend({root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=!1!==this.options.hashChange,this._hasHashChange="onhashchange"in window&&(void 0===document.documentMode||document.documentMode>7),this._useHashChange=this._wantsHashChange&&this._hasHashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!(!this.history||!this.history.pushState),this._usePushState=this._wantsPushState&&this._hasPushState,this.fragment=this.getFragment(),this.root=("/"+this.root+"/").replace(U,"/"),this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot()){return this.location.replace((this.root.slice(0,-1)||"/")+"#"+this.getPath()),!0}this._hasPushState&&this.atRoot()&&this.navigate(this.getHash(),{replace:!0})}if(!this._hasHashChange&&this._wantsHashChange&&!this._usePushState){this.iframe=document.createElement("iframe"),this.iframe.src="javascript:0",this.iframe.style.display="none",this.iframe.tabIndex=-1;var t=document.body,n=t.insertBefore(this.iframe,t.firstChild).contentWindow;n.document.open(),n.document.close(),n.location.hash="#"+this.fragment}var r=window.addEventListener||function(e,t){return attachEvent("on"+e,t)};if(this._usePushState?r("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe?r("hashchange",this.checkUrl,!1):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),!this.options.silent)return this.loadUrl()},stop:function(){var e=window.removeEventListener||function(e,t){return detachEvent("on"+e,t)};this._usePushState?e("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe&&e("hashchange",this.checkUrl,!1),this.iframe&&(document.body.removeChild(this.iframe),this.iframe=null),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),D.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){var t=this.getFragment();if(t===this.fragment&&this.iframe&&(t=this.getHash(this.iframe.contentWindow)),t===this.fragment)return!1;this.iframe&&this.navigate(t),this.loadUrl()},loadUrl:function(e){return!!this.matchRoot()&&(e=this.fragment=this.getFragment(e),i.some(this.handlers,function(t){if(t.route.test(e))return t.callback(e),!0}))},navigate:function(e,t){if(!D.started)return!1;t&&!0!==t||(t={trigger:!!t}),e=this.getFragment(e||"");var i=this.root;""!==e&&"?"!==e.charAt(0)||(i=i.slice(0,-1)||"/");var n=i+e;if(e=this.decodeFragment(e.replace(F,"")),this.fragment!==e){if(this.fragment=e,this._usePushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);if(this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getHash(this.iframe.contentWindow)){var r=this.iframe.contentWindow;t.replace||(r.document.open(),r.document.close()),this._updateHash(r.location,e,t.replace)}}return t.trigger?this.loadUrl(e):void 0}},_updateHash:function(e,t,i){if(i){e.replace(e.href.replace(/(javascript:|#).*$/,"")+"#"+t)}else e.hash="#"+t}}),t.history=new D,b.extend=w.extend=S.extend=E.extend=D.extend=function(e,t){var n,r=this;n=e&&i.has(e,"constructor")?e.constructor:function(){return r.apply(this,arguments)},i.extend(n,r,t);var s=function(){this.constructor=n};return s.prototype=r.prototype,n.prototype=new s,e&&i.extend(n.prototype,e),n.__super__=r.prototype,n};var B=function(){throw Error('A "url" property or function must be specified')},O=function(e,t){var i=t.error;t.error=function(n){i&&i.call(t.context,e,n,t),e.trigger("error",e,n,t)}};return t})}).call(t,i(3))}],[7]);